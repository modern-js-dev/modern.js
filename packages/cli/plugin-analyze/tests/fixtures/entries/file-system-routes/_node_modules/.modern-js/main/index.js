
const IS_BROWSER = typeof window !== 'undefined';
const MOUNT_ID = 'root';

import React from 'react';

import { createApp, bootstrap } from '@modern-js/runtime';

import App from '@_modern_js_internal/pages/_app.ts';

import { routes } from '@_modern_js_src/main/routes.js';

import { router, state } from '@modern-js/runtime/plugins';


import { immer, effects, autoActions, devtools } from '@modern-js/runtime/model';

                const createStatePlugins = (config) => {
                  const plugins = [];

                  
                      plugins.push(immer(config['immer']));
                      

                      plugins.push(effects(config['effects']));
                      

                      plugins.push(autoActions(config['autoActions']));
                      

                      plugins.push(devtools(config['devtools']));
                      

                  return plugins;
                }
              

let AppWrapper = null;

function render() {
  
  AppWrapper = createApp({
    plugins: [
     router({...{"historyOptions":{"basename":"/"},"routesConfig": { routes, globalApp: App },}, ...App?.config?.router}),
state({...{plugins: createStatePlugins(true)}, ...App?.config?.state}),
    ]
  })()

  if (IS_BROWSER) {
    bootstrap(AppWrapper, MOUNT_ID);
  }

  return AppWrapper

}

AppWrapper = render();

export default AppWrapper;;
